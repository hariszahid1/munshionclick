<%@daily_book_salary_details_raw_quantity = 0 %>
<%@daily_book_salary_details_f99_raw_quantity = 0 %>
<%@daily_book_salary_details_tile_raw_quantity = 0 %>
<%@daily_book_salary_details_raw_quantity = 0 %>
<%@daily_book_salary_details_f99_quantity = 0 %>
<%@daily_book_salary_details_tile_quantity = 0 %>
<%@daily_book_salary_details_quantity = 0 %>
<%@daily_book_salary_details_wast = 0 %>
<%@daily_book_salary_details_raw_quantity_rate = 0 %>
<%@daily_book_salary_details_quantity_rate = 0 %>
<%@daily_book_salary_details_coverge_rate=0%>
<%@daily_book_salary_details_gift_rate=0%>
<%@salary_details_khakar_f99_raw_quantity=0%>
<%@salary_details_khakar_tile_raw_quantity=0%>
<%@daily_book_salary_details_khakar_raw_quantity=0%>
<%@daily_book_salary_details_wast=0%>
<%@salary_details_khakar_quantity_from_pather=0%>
<%@salary_details_khakar_quantity_from_stock=0%>
<%@salary_details_pather_remaning_quanity_bhari=0%>
<%@salary_details_pather_remaning_quanity_chapa=0%>
<%@salary_details_pather_remaning_quanity_stock=0%>
<%production_blocks_bricks_quantity=0%>
<%production_blocks_tiles_quantity=0%>
<%total_cost=0%>
<%cost_per_line=0%>
<%per_product_cost=0%>
<%per_thousand_product_cost=0%>
<%item_quantity_per_line=0%>
<%total_item_quantity=0%>
<%per_ton_bricks=0%>
<%lines=0%>
<%total_bricks=0%>
<%n_lines=0%>
<%n_total_bricks=0%>


<div class="hidden" id="daily_books_list">
  <div class="row">
    <div class="col-lg-12 col-sm-12">
      <h1>Total Production Report</h1>
      <div class="col-lg-3 form-group float-left">
        <%= link_to daily_books_path(department_id: @departments.first.title), class: "btn btn-primary" do %>
                  <i class="fas fa-male" aria-hidden="true"></i>
                  <%=@departments.first.title%> Daily book
        <% end %>
      </div>
      <div class="col-lg-2 form-group float-left">
        <%= link_to khakar_daily_books_path(department_id: @departments.second.title), class: "btn btn-primary" do %>
          <i class="fas fa-truck" aria-hidden="true"></i>
          <%=@departments.second.title%> Daily book
        <% end %>
      </div>
      <div class="col-lg-2 form-group float-left">
        <%= link_to production_cycles_path, class: "btn btn-primary" do %>
          <i class="fas fa-sign-language" aria-hidden="true"></i>
          Bhari Daily Book
        <% end %>
      </div>
      <div class="col-lg-2 form-group float-left">
      <%= link_to jalai_production_cycles_path, class: "btn btn-primary" do %>
         <i class="fas fa-fire" aria-hidden="true"></i>
         Jalai Daily Book
       <% end %>
      </div>
      <div class="col-lg-2 form-group float-left">
        <%= link_to nakasi_production_cycles_path(department_id: @departments.third.title), class: "btn btn-primary" do %>
                  <i class="fas fa-align-justify" aria-hidden="true"></i>
                  <%=@departments.third.title%> Daily Book
        <% end %>
      </div>
    </div>
  </div>
  <div class="clearfix"></div>
  <div class="row">
    <div class="col-lg-12 col-sm-12">
      <%= search_form_for @q, url: total_production_report_daily_books_path, class: "admin-controls", method: "get" do |f| %>
        <div class="col-lg-2 form-group float-left">
          <%= f.search_field :book_date_gteq, class: 'form-control input-sm datepicker',value: @book_date_gteq, 'datepicker' => true,placeholder: "YYYY-MM-DD" %>
        </div>
        <div class="col-lg-2 form-group float-left">
          <%= f.search_field :book_date_lteq, class: 'form-control input-sm datepicker',value: @book_date_lteq, 'datepicker' => true ,placeholder: "YYYY-MM-DD"%>
        </div>
        <div class="col-lg-2 form-group float-left">
          <button class="form-control btn btn-primary" name="search_submit" type="submit" value="Search" style="width:100px"><i class="fa fa-search"></i></button>
        </div>
        <div class="col-lg-2 form-group float-left">
        </div>
        <div class="col-lg-2 form-group float-left">
        </div>
        <div class="col-lg-2 form-group float-left">
          <button class="form-control btn  badge badge-pill badge-danger" name="submit_pdf" type="submit" value="Daily Production Details PDF A4" formtarget="_blank" ><i class="fa fa-file-pdf"></i> Daily</button>
        </div>
      <% end %>
    </div>
  </div>
  <table data-toggle="table" >
    <thead>
      <h4>Pathair</h4>
      <tr>
        <th></th>
        <th><%= sort_link(@q, :salary_details_raw_quantity, 'Kachi') %></th>
        <th><%= sort_link(@q, :salary_details_raw_quantity, 'K Bricks') %></th>
        <th><%= sort_link(@q, :salary_details_raw_quantity, 'K Tile') %></th>
        <th><%= sort_link(@q, :salary_details_quantity, 'Paaki') %></th>
        <th><%= sort_link(@q, :salary_details_raw_quantity, 'P Bricks') %></th>
        <th><%= sort_link(@q, :salary_details_raw_quantity, 'P Tile') %></th>
      </tr>
    </thead>

    <tbody>
      <% @daily_books.each do |daily_book| %>
        <tr>
          <% daily_book.book_date.strftime("%d-%b-%y") %>
          <% daily_book.salary_details_raw_quantity.round(0) %><%@daily_book_salary_details_raw_quantity += daily_book.salary_details_raw_quantity %>
          <% daily_book.salary_details_f99_raw_quantity.round(0)%> <%@daily_book_salary_details_f99_raw_quantity += daily_book.salary_details_f99_raw_quantity %>
          <% daily_book.salary_details_tile_raw_quantity.round(0)%> <%@daily_book_salary_details_tile_raw_quantity += daily_book.salary_details_tile_raw_quantity %>
          <% daily_book.salary_details_quantity.round(0) %> <%@daily_book_salary_details_quantity += daily_book.salary_details_quantity %>
          <% daily_book.salary_details_f99_quantity.round(0)%> <%@daily_book_salary_details_f99_quantity += daily_book.salary_details_f99_quantity %>
          <% daily_book.salary_details_tile_quantity.round(0)%> <%@daily_book_salary_details_tile_quantity += daily_book.salary_details_tile_quantity %>
        </tr>
      <% end %>
      <tr>
        <td><h5>Total</h5></td>
        <td><h5><%=@daily_book_salary_details_raw_quantity%></h5></td>
        <td><h5><%=@daily_book_salary_details_f99_raw_quantity%></h5></td>
        <td><h5><%=@daily_book_salary_details_tile_raw_quantity%></h5></td>
        <td><h5><%=@daily_book_salary_details_quantity%></h5></td>
        <td><h5><%=@daily_book_salary_details_f99_quantity%></h5></td>
        <td><h5><%=@daily_book_salary_details_tile_quantity%></h5></td>
      </tr>
    </tbody>
  </table>


  <table data-toggle="table">
    <thead>
      <h4>Khakar</h4>
      <tr>
        <th></th>
        <th><%= sort_link(@q, :created_at, 'Pick up') %></th>
        <th><%= sort_link(@q, :created_at, 'From Pather') %></th>
        <th><%= sort_link(@q, :created_at, 'From Stock') %></th>
        <th><%= sort_link(@q, :department, 'Bricks') %></th>
        <th><%= sort_link(@q, :department, 'Tiles') %></th>
        <th><%= sort_link(@q, :department, 'Quantity') %></th>
        <th><%= sort_link(@q, :department, 'To Bhari') %></th>
        <th><%= sort_link(@q, :department, 'To Stock') %></th>
        <th><%= sort_link(@q, :department, 'To Chapa') %></th>
        <th><%= sort_link(@q, :department, 'Total') %></th>
        <th><%= sort_link(@q, :department, 'Wast') %></th>
      </tr>
    </thead>

    <tbody>
      <% @khakar_daily_books.each do |khakar_daily_book| %>
        <tr>
          <% khakar_daily_book.salary_details_khakar_quantity_from_pather.round(0)%> <%@salary_details_khakar_quantity_from_pather +=khakar_daily_book.salary_details_khakar_quantity_from_pather.round(0)%>
          <% khakar_daily_book.salary_details_khakar_quantity_from_stock.round(0)%> <%@salary_details_khakar_quantity_from_stock +=khakar_daily_book.salary_details_khakar_quantity_from_stock.round(0)%>
          <% khakar_daily_book.salary_details_khakar_f99_raw_quantity.round(0)%> <%@salary_details_khakar_f99_raw_quantity +=khakar_daily_book.salary_details_khakar_f99_raw_quantity.round(0)%>
          <% khakar_daily_book.salary_details_khakar_tile_raw_quantity.round(0)%> <%@salary_details_khakar_tile_raw_quantity +=khakar_daily_book.salary_details_khakar_tile_raw_quantity.round(0)%>
          <% khakar_daily_book.salary_details_khakar_quantity %> <%@daily_book_salary_details_khakar_raw_quantity += khakar_daily_book.salary_details_khakar_quantity.round(0) %>
          <% khakar_daily_book.salary_details_pather_remaning_quanity_bhari%><%@salary_details_pather_remaning_quanity_bhari += khakar_daily_book.salary_details_pather_remaning_quanity_bhari.round(0) %>
          <% khakar_daily_book.salary_details_pather_remaning_quanity_stock%><%@salary_details_pather_remaning_quanity_stock += khakar_daily_book.salary_details_pather_remaning_quanity_stock.round(0) %>
          <% khakar_daily_book.salary_details_pather_remaning_quanity_chapa%><%@salary_details_pather_remaning_quanity_chapa += khakar_daily_book.salary_details_pather_remaning_quanity_chapa.round(0) %>
          <% khakar_daily_book.salary_details_khakar_remaning %> <%@daily_book_salary_details_wast += khakar_daily_book.salary_details_khakar_remaning %>
          <% khakar_daily_book.salary_details_khakar_wast.to_f.round(2) %> <%@daily_book_salary_details_quantity_rate += khakar_daily_book.salary_details_khakar_wast %>

        </tr>
      <% end %>
      <tr>
        <td><h5>Total</h5></td>
        <td></td>
        <td><h5><%=@salary_details_khakar_quantity_from_pather%></h5></td>
        <td><h5><%=@salary_details_khakar_quantity_from_stock%></h5></td>
        <td><h5><%=@salary_details_khakar_f99_raw_quantity%></h5></td>
        <td><h5><%=@salary_details_khakar_tile_raw_quantity%></h5></td>
        <td><h5><%=@daily_book_salary_details_khakar_raw_quantity%></h5></td>
        <td><h5><%=@salary_details_pather_remaning_quanity_bhari%></h5></td>
        <td><h5><%=@salary_details_pather_remaning_quanity_stock%></h5></td>
        <td><h5><%=@salary_details_pather_remaning_quanity_chapa%></h5></td>
        <td><h5><%=@daily_book_salary_details_wast %></h5></td>
        <td><h5><%=@daily_book_salary_details_quantity_rate %></h5></td>

      </tr>
    </tbody>
  </table>

  <table data-toggle="table">
    <thead>
      <h4>Bharai</h4>
      <tr>
        <th></th>
        <th><%= sort_link(@p, :production_blocks_bricks_quantity, 'Bricks') %></th>
        <th><%= sort_link(@p, :production_blocks_tiles_quantity, 'Tiles') %></th>
        <th><%= sort_link(@p, :production_blocks_tiles_quantity, 'Total') %></th>
      </tr>
    </thead>

    <tbody>
      <% @production_cycles.each do |production_cycle| %>
        <tr>
          <% production_cycle.start_date.strftime("%d-%b-%y") %>

            <% production_cycle.production_blocks_bricks_quantity_with_date %>
            <% production_cycle.production_blocks_bricks_quantity %><% production_blocks_bricks_quantity+=production_cycle.production_blocks_bricks_quantity %>


            <% production_cycle.production_blocks_tiles_quantity_with_date %>
          <% production_cycle.production_blocks_tiles_quantity %><% production_blocks_tiles_quantity+=production_cycle.production_blocks_tiles_quantity %>

        </tr>
      <% end %>
      <tr>
        <td><h5>Total</h5></td>
        <td><h5><%=production_blocks_bricks_quantity%></h5></td>
        <td><h5><%=production_blocks_tiles_quantity%></h5></td>
        <td><h5><%=production_blocks_bricks_quantity.to_i+production_blocks_tiles_quantity.to_i%></h5></td>
      </tr>
    </tbody>
  </table>

  <table data-toggle="table" >
    <thead>
      <h4>Jalai</h4>
      <th></th>
      <th><%= sort_link(@j, :lines, 'Lines') %></th>
      <th><%= sort_link(@j, :total_bricks, 'T Bricks') %></th>
      <th><%= sort_link(@j, :total_cost, 'T Cost') %></th>
      <th><%= sort_link(@j, :cost_per_line, 'Cost/Line') %></th>
      <th><%= sort_link(@j, :per_thousand_product_cost, 'Cost/1000') %></th>
      <th><%= sort_link(@j, :per_product_cost, 'Cost/Brick') %></th>
      <th><%= sort_link(@j, :total_item_quantity, 'Total Quantity') %></th>
      <th><%= sort_link(@j, :item_quantity_per_line, 'Qunatity/Line') %></th>
      <th><%= sort_link(@j, :per_ton_bricks, 'Bricks/Ton') %></th>
      <th> <%= sort_link(@j, :total_item_quantity, 'Quantiity/Bricks') %></th>
    </thead>

    <tbody>
      <% @jalai_production_cycles.each do |jalai_production_cycle| %>
        <tr>
          <% jalai_production_cycle.start_date.strftime("%d-%b-%y") %>

            <%jalai_production_cycle.lines %><% lines+=jalai_production_cycle.lines %>


            <%jalai_production_cycle.total_bricks.to_i %><% total_bricks+=jalai_production_cycle.total_bricks.to_i %>

            <%jalai_production_cycle.total_cost.to_i %><% total_cost+=jalai_production_cycle.total_cost %>

            <%jalai_production_cycle.cost_per_line.to_i %><% cost_per_line+=jalai_production_cycle.cost_per_line %>

            <%jalai_production_cycle.per_thousand_product_cost.to_i %><% per_thousand_product_cost+=jalai_production_cycle.per_thousand_product_cost %>

            <%jalai_production_cycle.per_product_cost%><% per_product_cost+=jalai_production_cycle.per_product_cost%>

            <%jalai_production_cycle.total_item_quantity.to_i %><% total_item_quantity+=jalai_production_cycle.total_item_quantity %>

            <%jalai_production_cycle.item_quantity_per_line.to_i %><% item_quantity_per_line+=jalai_production_cycle.item_quantity_per_line %>

            <%jalai_production_cycle.per_ton_bricks.to_i %><% per_ton_bricks+=jalai_production_cycle.per_ton_bricks %>

            <%(jalai_production_cycle.total_item_quantity.to_f/jalai_production_cycle.total_bricks.to_f).round(4) %>

        </tr>
      <% end %>
      <tr>
        <td><h6>Total</h6></td>
        <td><h6><%=lines.to_i%></h6></td>
        <td><h6><%=total_bricks.to_i%></h6></td>
        <td><h6><%=total_cost.to_i%></h6></td>
        <td><h6><%=(total_cost/lines).to_i  if @production_cycles.present?%></h6></td>
        <td><h6><%=(total_cost/total_bricks).round(2)*1000 if total_cost!=total_bricks%></h6></td>
        <td><h6><%=(total_cost/total_bricks).round(2) if total_cost!=total_bricks%></h6></td>
        <td><h6><%=total_item_quantity.to_i%></h6></td>
        <td><h6><%=(total_item_quantity/lines.to_i).to_i  if @production_cycles.present?%></h6></td>
        <td><h6><%=((total_bricks/total_item_quantity)*1000.to_i).round(0)  if @production_cycles.present?%></h6></td>
        <td><h6><%=(total_item_quantity/total_bricks).round(3) if total_item_quantity.positive?%></h6></td>
      </tr>

    </tbody>
  </table>

  <table data-toggle="table" >
    <thead>
      <h5>nakasi</h5>
      <th></th>
      <th><%= sort_link(@j, :lines, 'Lines') %></th>
      <th><%= sort_link(@j, :total_bricks, 'T Bricks') %></th>
    </thead>

    <tbody>
      <% @nkasi_production_cycles.each do |nkasi_production_cycle| %>
        <tr>
          <% nkasi_production_cycle.start_date.strftime("%d-%b-%y") %>

            <%nkasi_production_cycle.lines %><% n_lines+=nkasi_production_cycle.lines %>

            <%nkasi_production_cycle.total_bricks.to_i %><% n_total_bricks+=nkasi_production_cycle.total_bricks.to_i %>

        </tr>
      <% end %>
      <tr>
        <td><h6>Total</h6></td>
        <td><h6><%=n_lines.to_i%></h6></td>
        <td><h6><%=n_total_bricks.to_i%></h6></td>
      </tr>

    </tbody>
  </table>
</div>

<div class="clearfix"></div>




<script>
  $(document).ready(function() {
    if ($(".bootstrap-table").length == 0){
      $("table").bootstrapTable();
    }
    $("#daily_books_list").removeClass('hidden');
    FontAwesome.dom.i2svg();
  });
</script>
